<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Duck Racing â€” Stable Slow</title>

<style>
body{margin:0;background:#0f172a;color:#fff;font-family:Inter,system-ui;display:flex;justify-content:center}
.container{max-width:960px;width:100%;padding:16px}
.card{background:#111827;border-radius:16px;padding:16px;box-shadow:0 10px 28px rgba(0,0,0,.45);margin-bottom:14px}
textarea{width:100%;min-height:90px;border-radius:12px;border:1px solid #334155;background:#020617;color:#fff;padding:12px}
button{width:100%;padding:12px;border-radius:12px;border:none;margin-top:8px;font-weight:700;background:#22c55e;color:#000}
.track{position:relative;margin-top:12px;background:#020617;border-radius:12px;border:1px solid #1e293b;padding:10px;overflow:hidden}
.finish{position:absolute;right:6px;top:6px;bottom:6px;width:3px;background:#ef4444}
.duck{display:flex;align-items:center;gap:8px;font-size:20px;margin:8px 0;position:relative;left:0;transition:left .15s linear}
#board li{
  list-style:none;
  margin:6px 0;
  padding:10px;
  border-radius:10px;
  background:#020617;
  color:#fff;          /* ğŸ‘ˆ Ä‘áº£m báº£o chá»¯ sÃ¡ng */
  font-weight:600;
  opacity:1;           /* ğŸ‘ˆ bá» lÃ m má» */
}

.top1{background:#fde047;color:#000}
.top2{background:#e5e7eb;color:#000}
.top3{background:#fb923c;color:#000}
.timer{font-size:13px;opacity:.8;margin-top:6px}
.buttons{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.reset{background:#38bdf8;color:#000}
</style>
</head>

<body>
<div class="container">
<div class="card">

<h2 style="text-align:center">ğŸ¤ Duck Racing â€” Stable</h2>

<p>Má»—i dÃ²ng 1 tÃªn:</p>
<textarea id="names"></textarea>

<div class="buttons">
  <button id="startBtn">Báº¯t Ä‘áº§u Ä‘ua</button>
  <button id="resetBtn" class="reset">ChÆ¡i láº¡i</button>
</div>

<div class="timer" id="timer"></div>

<div class="track" id="track">
  <div class="finish"></div>
</div>

<h3>ğŸ† Báº£ng xáº¿p háº¡ng</h3>
<ul id="board"></ul>

</div>
</div>

<script>
const btn=document.getElementById("startBtn");
const resetBtn=document.getElementById("resetBtn");
const track=document.getElementById("track");
const board=document.getElementById("board");
const timerEl=document.getElementById("timer");

let ducks=[], results=[], running=false, startTime=0, timerLoop=null, finishX=0;

function reset(){
  running=false;
  results=[];
  board.innerHTML="";
  timerEl.textContent="";
  clearInterval(timerLoop);
  track.querySelectorAll(".duck").forEach(e=>e.remove());
}

function startRace(){
  if(running) return; // cháº·n spam nÃºt
  reset();

  const names=document.getElementById("names").value
    .split("\n").map(s=>s.trim()).filter(Boolean);

  if(!names.length){alert("Nháº­p tÃªn trÆ°á»›c!");return;}

  const trackWidth=track.clientWidth;
  finishX=trackWidth-80; // cÄƒn chuáº©n icon + text

  ducks=names.map(name=>{
    const d=document.createElement("div");
    d.className="duck";
    d.dataset.x=0;
    d.dataset.name=name;
    d.dataset.done="0";
    d.innerHTML=`<span>ğŸ¦†</span><span>${name}</span>`;
    track.appendChild(d);
    return d;
  });

  running=true;
  startTime=performance.now();

  timerLoop=setInterval(()=>{
    const t=((performance.now()-startTime)/1000).toFixed(2);
    timerEl.textContent="â± "+t+"s";
  },150);

  requestAnimationFrame(loop);
}

function loop(){
  if(!running) return;

  ducks.forEach(d=>{
    if(d.dataset.done==="1") return;

    let x=+d.dataset.x;

    // tá»‘c Ä‘á»™ á»•n Ä‘á»‹nh + mÆ°á»£t
    x+=0.8 + Math.random()*0.9;

    if(x>=finishX){
      x=finishX;
      d.dataset.done="1";

      const t=(performance.now()-startTime)/1000;
      results.push({name:d.dataset.name,time:t});

      d.style.left=x+"px";
      updateRanking();

      if(results.length===ducks.length){
        running=false;
        clearInterval(timerLoop);
      }
      return;
    }

    d.dataset.x=x;
    d.style.left=x+"px";
  });

  requestAnimationFrame(loop);
}

function updateRanking(){
  results.sort((a,b)=>a.time-b.time);
  board.innerHTML="";

  results.forEach((r,i)=>{
    const li=document.createElement("li");
    li.textContent=`${i+1}. ${r.name} â€” ${r.time.toFixed(2)}s`;
    if(i===0) li.classList.add("top1");
    if(i===1) li.classList.add("top2");
    if(i===2) li.classList.add("top3");
    board.appendChild(li);
  });
}

btn.onclick=startRace;
resetBtn.onclick=reset;
</script>
</body>
</html>
